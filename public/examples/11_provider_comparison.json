{
  "id": "11_provider_comparison",
  "title": "Provider Comparison Demo",
  "tier": 4,
  "category": "Real-World",
  "description": "See Amplifier's key strength - trivially easy provider swapping. This example shows\nhow to compare d",
  "estimatedTimeMinutes": 5,
  "minAudience": "developers",
  "isFeatured": false,
  "difficulty": "advanced",
  "tags": [
    "composition"
  ],
  "githubUrl": "https://github.com/microsoft/amplifier-foundation/blob/main/examples/11_provider_comparison.py",
  "content": {
    "everyone": {
      "title": "Provider Comparison Demo",
      "valueProposition": "See Amplifier's key strength - trivially easy provider swapping. This example shows\nhow to compare different providers and demonstrates that swapping is just one line of code.",
      "howItWorks": [
        "Set up your AI environment",
        "Configure the agent with the right capabilities",
        "Run the example and see results",
        "Understand what happened"
      ],
      "whatYouGet": [
        "Working example you can run",
        "Clear understanding of the concept",
        "Foundation for building more"
      ]
    },
    "developers": {
      "title": "11_provider_comparison.py - Provider Comparison Demo",
      "valueProposition": "See Amplifier's key strength - trivially easy provider swapping. This example shows\nhow to compare different providers and demonstrates that swapping is just one line of code.",
      "howItWorks": "- How to swap providers by changing one bundle path\n- Pattern for comparing provider performance\n- Cost/speed tradeoff considerations\n- How Amplifier's abstraction makes providers interchangeable",
      "keyConcepts": [
        "How to swap providers by changing one bundle path",
        "Pattern for comparing provider performance",
        "Cost/speed tradeoff considerations",
        "How Amplifier's abstraction makes providers interchangeable"
      ],
      "codeOverview": {
        "structure": [
          "Load foundation and provider bundles",
          "Compose bundles together",
          "Prepare modules (download if needed)",
          "Create AI session",
          "Execute prompts and get responses"
        ],
        "keyFunctions": [
          {
            "name": "load_bundle",
            "description": "Loads a bundle from path or URL",
            "usage": "load_bundle(str(foundation_path)"
          },
          {
            "name": "compose",
            "description": "Combines multiple bundles",
            "usage": "compose(provider)"
          },
          {
            "name": "prepare",
            "description": "Downloads and activates modules",
            "usage": "prepare()"
          },
          {
            "name": "create_session",
            "description": "Creates an AI session",
            "usage": "create_session()"
          },
          {
            "name": "execute",
            "description": "Executes a prompt",
            "usage": "execute(prompt)"
          }
        ]
      },
      "codeSnippet": "async def main():\n    \"\"\"Main entry point.\"\"\"\n\n    print(\"\ud83d\ude80 Provider Comparison Demo\")\n    print(\"=\" * 80)\n    print(\"\\nVALUE: Understand provider swapping and make informed model choices\")\n    print(\"AUDIENCE: Developers and PMs making cost/performance decisions\")\n\n    # Check prerequisites\n    if not os.getenv(\"ANTHROPIC_API_KEY\"):\n        print(\"\\n\u274c ERROR: Set ANTHROPIC_API_KEY environment variable\")\n        print(\"\\nExample:\")\n        print(\"  export ANTHROPIC_API_KEY='your-key-here'\")\n        print(\"  python 11_provider_comparison.py\")\n        return"
    },
    "experts": {
      "title": "11_provider_comparison.py - Provider Comparison Demo",
      "complexity": "Tier 4 - Real-World Applications",
      "sourceUrl": "https://github.com/microsoft/amplifier-foundation/blob/main/examples/11_provider_comparison.py",
      "architecture": "See Amplifier's key strength - trivially easy provider swapping. This example shows\nhow to compare different providers and demonstrates that swapping is just one line of code.",
      "fullCode": "#!/usr/bin/env python3\n\"\"\"\nExample 11: Provider Comparison Demo\n====================================\n\nVALUE PROPOSITION:\nSee Amplifier's key strength - trivially easy provider swapping. This example shows\nhow to compare different providers and demonstrates that swapping is just one line of code.\n\nWHAT YOU'LL LEARN:\n- How to swap providers by changing one bundle path\n- Pattern for comparing provider performance\n- Cost/speed tradeoff considerations\n- How Amplifier's abstraction makes providers interchangeable\n\nAUDIENCE:\nDevelopers and PMs making cost/performance decisions\n\"\"\"\n\nimport asyncio\nimport os\nimport time\nfrom dataclasses import dataclass\nfrom pathlib import Path\n\nfrom amplifier_foundation import load_bundle\n\n# =============================================================================\n# SECTION 1: Provider Execution Pattern\n# =============================================================================\n\n\n@dataclass\nclass ProviderResult:\n    \"\"\"Results from a provider execution.\"\"\"\n\n    provider_name: str\n    model_name: str\n    response: str\n    duration: float\n    estimated_cost: str\n\n\nasync def test_provider(provider_bundle_path: Path, prompt: str) -> ProviderResult:\n    \"\"\"Test a single provider and measure performance.\n\n    Args:\n        provider_bundle_path: Path to provider bundle (e.g., providers/anthropic-sonnet.yaml)\n        prompt: Prompt to execute\n\n    Returns:\n        ProviderResult with timing and response\n    \"\"\"\n    # Load foundation\n    foundation_path = Path(__file__).parent.parent\n    foundation = await load_bundle(str(foundation_path))\n\n    # Load provider - THIS IS THE LINE THAT CHANGES TO SWAP PROVIDERS\n    provider = await load_bundle(str(provider_bundle_path))\n\n    # Get provider info\n    provider_name = provider.name\n    model_name = \"unknown\"\n    if provider.providers and len(provider.providers) > 0:\n        model_name = provider.providers[0].get(\"config\", {}).get(\"default_model\", \"unknown\")\n\n    print(f\"\\n  \u23f3 Testing {provider_name} ({model_name})...\")\n\n    # Compose foundation + provider\n    composed = foundation.compose(provider)\n\n    # Prepare (downloads modules if needed)\n    print(\"     Preparing modules...\")\n    prepared = await composed.prepare()\n\n    # Create session\n    session = await prepared.create_session()\n\n    # Execute with timing\n    print(\"     Executing prompt...\")\n    start_time = time.time()\n\n    async with session:\n        response = await session.execute(prompt)\n\n    duration = time.time() - start_time\n\n    # Estimate cost (rough approximation)\n    input_tokens = len(prompt) // 4  # ~4 chars per token\n    output_tokens = len(response) // 4\n\n    if \"haiku\" in model_name.lower():\n        cost = f\"~${(input_tokens * 0.8 + output_tokens * 4.0) / 1_000_000:.4f} (cheap)\"\n    elif \"sonnet\" in model_name.lower():\n        cost = f\"~${(input_tokens * 3.0 + output_tokens * 15.0) / 1_000_000:.4f} (balanced)\"\n    elif \"opus\" in model_name.lower():\n        cost = f\"~${(input_tokens * 15.0 + output_tokens * 75.0) / 1_000_000:.4f} (premium)\"\n    else:\n        cost = \"unknown\"\n\n    print(f\"     \u2713 Completed in {duration:.2f}s\")\n\n    return ProviderResult(\n        provider_name=provider_name, model_name=model_name, response=response, duration=duration, estimated_cost=cost\n    )\n\n\n# =============================================================================\n# SECTION 2: Single Provider Demo (Fast)\n# =============================================================================\n\n\nasync def single_provider_demo():\n    \"\"\"Demonstrate single provider usage - fast demo.\"\"\"\n\n    print(\"\\n\" + \"=\" * 80)\n    print(\"DEMO: Single Provider Test\")\n    print(\"=\" * 80)\n    print(\"\\nThis shows the basic pattern. To compare providers, run this\")\n    print(\"same code with different provider bundle paths.\")\n\n    # Test prompt\n    prompt = \"Explain recursion in programming with a simple Python example.\"\n\n    print(f\"\\n\ud83d\udcdd Prompt: {prompt}\")\n\n    # Test with Anthropic Sonnet (balanced)\n    provider_path = Path(__file__).parent.parent / \"providers\" / \"anthropic-sonnet.yaml\"\n\n    result = await test_provider(provider_path, prompt)\n\n    # Display result\n    print(\"\\n\" + \"=\" * 80)\n    print(\"\ud83d\udcca Result\")\n    print(\"=\" * 80)\n    print(f\"Provider: {result.provider_name}\")\n    print(f\"Model: {result.model_name}\")\n    print(f\"Time: {result.duration:.2f}s\")\n    print(f\"Cost: {result.estimated_cost}\")\n    print(\"\\nResponse preview:\")\n    print(\"-\" * 80)\n    print(result.response[:400] + \"...\" if len(result.response) > 400 else result.response)\n\n\n# =============================================================================\n# SECTION 3: How to Compare Providers\n# =============================================================================\n\n\ndef show_comparison_pattern():\n    \"\"\"Show the code pattern for comparing providers.\"\"\"\n\n    print(\"\\n\" + \"=\" * 80)\n    print(\"\ud83d\udca1 HOW TO COMPARE PROVIDERS\")\n    print(\"=\" * 80)\n\n    print(\"\"\"\nTo compare providers, just change ONE line - the provider bundle path:\n\n```python\n# Test with Claude Sonnet (balanced)\nprovider = await load_bundle(\"providers/anthropic-sonnet.yaml\")\n\n# Change to Claude Haiku (fast/cheap)\nprovider = await load_bundle(\"providers/anthropic-haiku.yaml\")\n\n# Change to Claude Opus (premium quality)\nprovider = await load_bundle(\"providers/anthropic-opus.yaml\")\n\n# Change to OpenAI GPT-4 (alternative)\nprovider = await load_bundle(\"providers/openai-gpt.yaml\")\n```\n\nThat's it! The rest of your code stays exactly the same. This is the power\nof Amplifier's provider abstraction - providers are truly interchangeable.\n\nTo run a comparison:\n1. Run this script with each provider\n2. Compare timing, cost, and response quality\n3. Choose the right model for your use case:\n   - Haiku: Fast, cheap, good for simple tasks\n   - Sonnet: Balanced quality and cost (default choice)\n   - Opus: Premium quality for complex reasoning\n   - GPT-4: Alternative perspective, different strengths\n\"\"\")\n\n\n# =============================================================================\n# SECTION 4: Cost/Speed Tradeoff Guide\n# =============================================================================\n\n\ndef show_tradeoff_guide():\n    \"\"\"Show when to use which provider.\"\"\"\n\n    print(\"\\n\" + \"=\" * 80)\n    print(\"\ud83c\udfaf WHEN TO USE WHICH MODEL\")\n    print(\"=\" * 80)\n\n    print(\"\"\"\nMODEL SELECTION GUIDE:\n\n\ud83d\udfe2 Claude Haiku (Fast & Cheap)\n  Speed: ~0.5-1s\n  Cost: ~$0.0002 per request\n  Use for:\n    - Simple text transformations\n    - Data extraction from structured text\n    - Quick translations\n    - High-volume batch processing\n\n\ud83d\udfe1 Claude Sonnet (Balanced) \u2b50 RECOMMENDED DEFAULT\n  Speed: ~1-2s\n  Cost: ~$0.003 per request\n  Use for:\n    - Code generation and review\n    - Content writing\n    - Most general-purpose tasks\n    - When you need good quality without premium cost\n\n\ud83d\udd34 Claude Opus (Premium Quality)\n  Speed: ~2-3s\n  Cost: ~$0.015 per request\n  Use for:\n    - Complex reasoning tasks\n    - Critical code reviews\n    - Research and analysis\n    - When quality matters most\n\n\ud83d\udd35 GPT-4 (Alternative)\n  Speed: ~1.5-2s\n  Cost: ~$0.006 per request\n  Use for:\n    - Getting a different perspective\n    - Tasks where GPT-4 excels (varies by domain)\n    - When you want model diversity\n\nCOST OPTIMIZATION STRATEGY:\n1. Start with Sonnet (balanced)\n2. Use Haiku for simple, high-volume tasks\n3. Reserve Opus for critical tasks\n4. A/B test to find the right model for each use case\n\"\"\")\n\n\n# =============================================================================\n# SECTION 5: Main Entry Point\n# =============================================================================\n\n\nasync def main():\n    \"\"\"Main entry point.\"\"\"\n\n    print(\"\ud83d\ude80 Provider Comparison Demo\")\n    print(\"=\" * 80)\n    print(\"\\nVALUE: Understand provider swapping and make informed model choices\")\n    print(\"AUDIENCE: Developers and PMs making cost/performance decisions\")\n\n    # Check prerequisites\n    if not os.getenv(\"ANTHROPIC_API_KEY\"):\n        print(\"\\n\u274c ERROR: Set ANTHROPIC_API_KEY environment variable\")\n        print(\"\\nExample:\")\n        print(\"  export ANTHROPIC_API_KEY='your-key-here'\")\n        print(\"  python 11_provider_comparison.py\")\n        return\n\n    # Run single provider demo\n    await single_provider_demo()\n\n    # Show comparison pattern\n    show_comparison_pattern()\n\n    # Show tradeoff guide\n    show_tradeoff_guide()\n\n    # Summary\n    print(\"\\n\" + \"=\" * 80)\n    print(\"\ud83d\udcda WHAT YOU LEARNED:\")\n    print(\"=\" * 80)\n    print(\"  \u2713 Provider swapping is ONE line of code in Amplifier\")\n    print(\"  \u2713 Providers are truly interchangeable - same code works with any\")\n    print(\"  \u2713 Cost/speed/quality tradeoffs guide model selection\")\n    print(\"  \u2713 Pattern for running your own comparisons\")\n\n    print(\"\\n\" + \"=\" * 80)\n    print(\"\ud83c\udf93 KEY TAKEAWAY\")\n    print(\"=\" * 80)\n    print(\"\"\"\nAmplifier's provider abstraction means you can:\n  1. Start with one model\n  2. Swap to another anytime (one line change)\n  3. Test different models on real tasks\n  4. Optimize costs without rewriting code\n\nThis flexibility is unique to Amplifier's architecture!\n\"\"\")\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n",
      "advancedOptions": {
        "provider": [
          "anthropic-sonnet",
          "anthropic-opus",
          "openai-gpt4"
        ],
        "streaming": false,
        "hooks": []
      }
    }
  },
  "execution": {
    "requiresInput": true,
    "defaultPrompt": null,
    "estimatedDuration": "2-5 seconds",
    "prerequisites": [
      "ANTHROPIC_API_KEY environment variable"
    ]
  }
}